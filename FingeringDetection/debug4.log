WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1752907051.034821 2892537 gl_context_egl.cc:85] Successfully initialized EGL. Major : 1 Minor: 5
I0000 00:00:1752907051.095076 2892843 gl_context.cc:369] GL version: 3.2 (OpenGL ES 3.2 NVIDIA 575.57.08), renderer: NVIDIA GeForce RTX 4090/PCIe/SSE2
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
? PyTorch 사용 가능
? CUDA GPU 사용 가능: NVIDIA GeForce RTX 4090
🔬 Using device: cuda (Scientific Grade Precision)
? PyTorch Floating Hands 모듈 로드 성공
? MIDI 비교 모듈 로드 성공
🔬 PyTorch Floating Hand Detection
============================================================
📊 현재 설정: 최대 10개 비디오, 임계값 0.9

🎯 통합 모드: Floating Detection + 깊이값 저장 + 결과 비디오 생성
============================================================
📁 videocapture 폴더에서 발견된 비디오: 107개
📊 분석 결과:
   ✅ 이미 처리된 비디오: 0개
   🔄 미처리 비디오: 107개

🎯 Raw 비디오를 직접 처리합니다
📝 107개 중 최신 10개만 선택

🎯 처리 대상 비디오: 10개
   📋 처리 방식: Raw 비디오 직접 처리
   1. 2024-09-05_22-11-07
   2. 2024-09-05_21-37-08
   3. 2024-09-05_21-31-00
   4. 2024-09-05_21-26-38
   5. 2024-09-05_21-18-58
   6. 2024-09-05_21-13-49
   7. 2024-09-05_21-07-35
   8. 2024-09-05_21-04-38
   9. 2024-09-05_21-01-27
   10. 2024-09-05_20-51-00
🎯 통합 처리 실행:
   ✅ Floating Detection (임계값: 0.9)
   💾 깊이 데이터 저장
   📹 결과 비디오 생성
   📊 최대 10개 비디오 처리


? 대상 비디오 해상도 체크:
============================================================
? 2024-09-05_22-11-07:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 29,289개
   길이: 488.1초 (8.1분)
? 2024-09-05_21-37-08:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 50,608개
   길이: 843.5초 (14.1분)
? 2024-09-05_21-31-00:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 3,853개
   길이: 64.2초 (1.1분)
? 2024-09-05_21-26-38:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 7,174개
   길이: 119.6초 (2.0분)
? 2024-09-05_21-18-58:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 13,718개
   길이: 228.6초 (3.8분)
? 2024-09-05_21-13-49:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 11,328개
   길이: 188.8초 (3.1분)
? 2024-09-05_21-07-35:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 15,815개
   길이: 263.6초 (4.4분)
? 2024-09-05_21-04-38:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 5,076개
   길이: 84.6초 (1.4분)
? 2024-09-05_21-01-27:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 5,783개
   길이: 96.4초 (1.6분)
? 2024-09-05_20-51-00:
   해상도: 1920x1080 (비율: 0.562)
   FPS: 60, 총 프레임: 18,036개
   길이: 300.6초 (5.0분)

? 해상도 통계:
   고유 해상도: 1가지
   1920x1080: 10개 비디오
   평균 FPS: 60.0
   총 길이: 2678.0초 (44.6분)

================================================================================
? [1/10] 비디오 처리 중: 2024-09-05_22-11-07
   임계값: 0.9
================================================================================
? 2024-09-05_22-11-07 PyTorch Detection 시작 (1200프레임 제한)
============================================================
? 성능 모니터링 시작
? 시스템 정보:
   ??  CPU: 64코어
   ? RAM: 172.8GB
   ? GPU: NVIDIA GeForce RTX 4090 (23.5GB)

? [1/4] 데이터 로드 및 초기화
? 데이터 검색 중...
🔍 데이터 검색: 2024-09-05_22-11-07
   🎬 처리된 데이터가 없음 → Raw 비디오 모드로 진행
   ? 진행: 1/3 (33.3%) 데이터 위치: Raw 비디오: /home/jhbae/PianoVAM-Code/FingeringDetection/videocapture/2024-09-05_22-11-07.mp4
? 손 데이터 및 비디오 정보 로딩 중...
🎬 Raw 비디오 직접 처리 모드
🎬 Raw 비디오 MediaPipe 처리 시작: 2024-09-05_22-11-07
   📊 비디오 정보: 1920x1080, 60.0FPS, 29,289프레임
   ⏱️  Quick test: 1,200프레임으로 제한
W0000 00:00:1752907051.135142 2892799 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1752907051.156234 2892821 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
2025-07-19 15:37:31.235 
  [33m[1mWarning:[0m to view this Streamlit app on a browser, run it with the following
  command:

    streamlit run torch_floating_detector.py [ARGUMENTS]
W0000 00:00:1752907051.335292 2892810 landmark_projection_calculator.cc:186] Using NORM_RECT without IMAGE_DIMENSIONS is only supported for the square ROI. Provide IMAGE_DIMENSIONS or use PROJECTION_MATRIX.

I0000 00:00:1752907095.156735 2892537 gl_context_egl.cc:85] Successfully initialized EGL. Major : 1 Minor: 5
I0000 00:00:1752907095.199414 2893225 gl_context.cc:369] GL version: 3.2 (OpenGL ES 3.2 NVIDIA 575.57.08), renderer: NVIDIA GeForce RTX 4090/PCIe/SSE2
✅ MediaPipe 처리 완료:
   📊 총 손 감지: 2,339개
   🎯 손이 있는 프레임: 1,200/1,200개
   📐 비디오 비율: 0.562
🎬 Raw 비디오 처리 완료:
   📊 생성된 handlist: 1200프레임
   📐 비디오 비율: 0.562
   ? 진행: 2/3 (66.7%) handlist: 1200프레임 로딩 완료
   ? 진행: 3/3 (100.0%) 분석 준비: 2,339개 손 데이터
   ? 완료: 총 2,339개 손, 1200프레임 로딩 완료 (44.09초)

? PyTorch Floating Detection 시작...

? [2/4] PyTorch GPU 가속 알고리즘 실행
? PyTorch 처리 대상 분석:
   ? 총 손 데이터: 2,339개
   ??  유효 프레임: 1,200개
   ? 비디오 비율: 0.562
? GPU 가속 환경:
   ? GPU: NVIDIA GeForce RTX 4090
   ? VRAM: 23.5GB
   ? Compute: 8.9
   ? CUDA: 12.6
? 알고리즘: PyTorch GPU 가속
   ? 해법: 고정점 반복법 (Fixed-point Iteration)
   ? 정밀도: 32-bit 단정밀도 (성능 최적화)
   ? 처리: 배치 병렬 처리 (GPU vectorized)
   ? 최적화:
      ? GPU 텐서 연산 최적화
      ? 배치 처리 (2048-8192개 동시)
      ? 메모리 스트리밍
      ? 벡터화 연산 (CUDA 커널)
      ? 자동 미분 비활성화
   ? 진행: 1/4 (25.0%) 손 골격 모델 생성 중...
? PyTorch 모델 생성 시작:
? Creating hand skeleton model with PyTorch...
? PyTorch 처리 중 오류 발생: list index out of range

? 전체 처리 완료: 44.15초
? [1/10] 실패: 2024-09-05_22-11-07
   오류: list index out of range

================================================================================
? [2/10] 비디오 처리 중: 2024-09-05_21-37-08
   임계값: 0.9
================================================================================
? 2024-09-05_21-37-08 PyTorch Detection 시작 (1200프레임 제한)
============================================================
? 성능 모니터링 시작
? 시스템 정보:
   ??  CPU: 64코어
   ? RAM: 172.8GB
   ? GPU: NVIDIA GeForce RTX 4090 (23.5GB)

? [1/4] 데이터 로드 및 초기화
? 데이터 검색 중...
🔍 데이터 검색: 2024-09-05_21-37-08
   🎬 처리된 데이터가 없음 → Raw 비디오 모드로 진행
   ? 진행: 1/3 (33.3%) 데이터 위치: Raw 비디오: /home/jhbae/PianoVAM-Code/FingeringDetection/videocapture/2024-09-05_21-37-08.mp4
? 손 데이터 및 비디오 정보 로딩 중...
🎬 Raw 비디오 직접 처리 모드
🎬 Raw 비디오 MediaPipe 처리 시작: 2024-09-05_21-37-08
   📊 비디오 정보: 1920x1080, 60.0FPS, 50,608프레임
   ⏱️  Quick test: 1,200프레임으로 제한
W0000 00:00:1752907095.240718 2893173 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1752907095.262348 2893201 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.

I0000 00:00:1752907139.026861 2892537 gl_context_egl.cc:85] Successfully initialized EGL. Major : 1 Minor: 5
I0000 00:00:1752907139.070979 2893539 gl_context.cc:369] GL version: 3.2 (OpenGL ES 3.2 NVIDIA 575.57.08), renderer: NVIDIA GeForce RTX 4090/PCIe/SSE2
✅ MediaPipe 처리 완료:
   📊 총 손 감지: 2,340개
   🎯 손이 있는 프레임: 1,195/1,200개
   📐 비디오 비율: 0.562
🎬 Raw 비디오 처리 완료:
   📊 생성된 handlist: 1200프레임
   📐 비디오 비율: 0.562
   ? 진행: 2/3 (66.7%) handlist: 1200프레임 로딩 완료
   ? 진행: 3/3 (100.0%) 분석 준비: 2,340개 손 데이터
   ? 완료: 총 2,340개 손, 1200프레임 로딩 완료 (43.80초)

? PyTorch Floating Detection 시작...

? [2/4] PyTorch GPU 가속 알고리즘 실행
? PyTorch 처리 대상 분석:
   ? 총 손 데이터: 2,340개
   ??  유효 프레임: 1,195개
   ? 비디오 비율: 0.562
? GPU 가속 환경:
   ? GPU: NVIDIA GeForce RTX 4090
   ? VRAM: 23.5GB
   ? Compute: 8.9
   ? CUDA: 12.6
? 알고리즘: PyTorch GPU 가속
   ? 해법: 고정점 반복법 (Fixed-point Iteration)
   ? 정밀도: 32-bit 단정밀도 (성능 최적화)
   ? 처리: 배치 병렬 처리 (GPU vectorized)
   ? 최적화:
      ? GPU 텐서 연산 최적화
      ? 배치 처리 (2048-8192개 동시)
      ? 메모리 스트리밍
      ? 벡터화 연산 (CUDA 커널)
      ? 자동 미분 비활성화
   ? 진행: 1/4 (25.0%) 손 골격 모델 생성 중...
? PyTorch 모델 생성 시작:
? Creating hand skeleton model with PyTorch...
? PyTorch 처리 중 오류 발생: list index out of range

? 전체 처리 완료: 43.86초
? [2/10] 실패: 2024-09-05_21-37-08
   오류: list index out of range

================================================================================
? [3/10] 비디오 처리 중: 2024-09-05_21-31-00
   임계값: 0.9
================================================================================
? 2024-09-05_21-31-00 PyTorch Detection 시작 (1200프레임 제한)
============================================================
? 성능 모니터링 시작
? 시스템 정보:
   ??  CPU: 64코어
   ? RAM: 172.8GB
   ? GPU: NVIDIA GeForce RTX 4090 (23.5GB)

? [1/4] 데이터 로드 및 초기화
? 데이터 검색 중...
🔍 데이터 검색: 2024-09-05_21-31-00
   🎬 처리된 데이터가 없음 → Raw 비디오 모드로 진행
   ? 진행: 1/3 (33.3%) 데이터 위치: Raw 비디오: /home/jhbae/PianoVAM-Code/FingeringDetection/videocapture/2024-09-05_21-31-00.mp4
? 손 데이터 및 비디오 정보 로딩 중...
🎬 Raw 비디오 직접 처리 모드
🎬 Raw 비디오 MediaPipe 처리 시작: 2024-09-05_21-31-00
   📊 비디오 정보: 1920x1080, 60.0FPS, 3,853프레임
   ⏱️  Quick test: 1,200프레임으로 제한
W0000 00:00:1752907139.096527 2893491 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1752907139.130562 2893510 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.

I0000 00:00:1752907188.400061 2892537 gl_context_egl.cc:85] Successfully initialized EGL. Major : 1 Minor: 5
I0000 00:00:1752907188.449098 2893866 gl_context.cc:369] GL version: 3.2 (OpenGL ES 3.2 NVIDIA 575.57.08), renderer: NVIDIA GeForce RTX 4090/PCIe/SSE2
✅ MediaPipe 처리 완료:
   📊 총 손 감지: 1,200개
   🎯 손이 있는 프레임: 1,200/1,200개
   📐 비디오 비율: 0.562
🎬 Raw 비디오 처리 완료:
   📊 생성된 handlist: 1200프레임
   📐 비디오 비율: 0.562
   ? 진행: 2/3 (66.7%) handlist: 1200프레임 로딩 완료
   ? 진행: 3/3 (100.0%) 분석 준비: 1,200개 손 데이터
   ? 완료: 총 1,200개 손, 1200프레임 로딩 완료 (49.33초)

? PyTorch Floating Detection 시작...

? [2/4] PyTorch GPU 가속 알고리즘 실행
? PyTorch 처리 대상 분석:
   ? 총 손 데이터: 1,200개
   ??  유효 프레임: 1,200개
   ? 비디오 비율: 0.562
? GPU 가속 환경:
   ? GPU: NVIDIA GeForce RTX 4090
   ? VRAM: 23.5GB
   ? Compute: 8.9
   ? CUDA: 12.6
? 알고리즘: PyTorch GPU 가속
   ? 해법: 고정점 반복법 (Fixed-point Iteration)
   ? 정밀도: 32-bit 단정밀도 (성능 최적화)
   ? 처리: 배치 병렬 처리 (GPU vectorized)
   ? 최적화:
      ? GPU 텐서 연산 최적화
      ? 배치 처리 (2048-8192개 동시)
      ? 메모리 스트리밍
      ? 벡터화 연산 (CUDA 커널)
      ? 자동 미분 비활성화
   ? 진행: 1/4 (25.0%) 손 골격 모델 생성 중...
? PyTorch 모델 생성 시작:
? Creating hand skeleton model with PyTorch...
? PyTorch 처리 중 오류 발생: list index out of range

? 전체 처리 완료: 49.37초
? [3/10] 실패: 2024-09-05_21-31-00
   오류: list index out of range

================================================================================
? [4/10] 비디오 처리 중: 2024-09-05_21-26-38
   임계값: 0.9
================================================================================
? 2024-09-05_21-26-38 PyTorch Detection 시작 (1200프레임 제한)
============================================================
? 성능 모니터링 시작
? 시스템 정보:
   ??  CPU: 64코어
   ? RAM: 172.8GB
   ? GPU: NVIDIA GeForce RTX 4090 (23.5GB)

? [1/4] 데이터 로드 및 초기화
? 데이터 검색 중...
🔍 데이터 검색: 2024-09-05_21-26-38
   🎬 처리된 데이터가 없음 → Raw 비디오 모드로 진행
   ? 진행: 1/3 (33.3%) 데이터 위치: Raw 비디오: /home/jhbae/PianoVAM-Code/FingeringDetection/videocapture/2024-09-05_21-26-38.mp4
? 손 데이터 및 비디오 정보 로딩 중...
🎬 Raw 비디오 직접 처리 모드
🎬 Raw 비디오 MediaPipe 처리 시작: 2024-09-05_21-26-38
   📊 비디오 정보: 1920x1080, 60.0FPS, 7,174프레임
   ⏱️  Quick test: 1,200프레임으로 제한
W0000 00:00:1752907188.475300 2893817 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1752907188.510232 2893844 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
